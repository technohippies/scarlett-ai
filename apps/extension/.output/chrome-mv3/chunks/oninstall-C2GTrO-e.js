import"./_virtual_wxt-html-plugins-DPbbfBKe.js";const J=!1,Z=(t,e)=>t===e,S={equals:Z};let R=Q;const w=1,v=2,H={owned:null,cleanups:null,context:null,owner:null};var d=null;let I=null,z=null,a=null,u=null,g=null,C=0;function tt(t,e){const s=a,n=d,i=t.length===0,l=e===void 0?n:e,r=i?H:{owned:null,cleanups:null,context:l?l.context:null,owner:l},o=i?t:()=>t(()=>$(()=>y(r)));d=r,a=null;try{return x(o,!0)}finally{a=s,d=n}}function U(t,e){e=e?Object.assign({},S,e):S;const s={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(s.value)),K(s,i));return[q.bind(s),n]}function N(t,e,s){const n=B(t,e,!1,w);m(n)}function et(t,e,s){R=it;const n=B(t,e,!1,w);n.user=!0,g?g.push(n):m(n)}function st(t,e,s){s=s?Object.assign({},S,s):S;const n=B(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=s.equals||void 0,m(n),q.bind(n)}function $(t){if(a===null)return t();const e=a;a=null;try{return t()}finally{a=e}}function nt(t){et(()=>$(t))}function q(){if(this.sources&&this.state)if(this.state===w)m(this);else{const t=u;u=null,x(()=>T(this),!1),u=t}if(a){const t=this.observers?this.observers.length:0;a.sources?(a.sources.push(this),a.sourceSlots.push(t)):(a.sources=[this],a.sourceSlots=[t]),this.observers?(this.observers.push(a),this.observerSlots.push(a.sources.length-1)):(this.observers=[a],this.observerSlots=[a.sources.length-1])}return this.value}function K(t,e,s){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&x(()=>{for(let i=0;i<t.observers.length;i+=1){const l=t.observers[i],r=I&&I.running;r&&I.disposed.has(l),(r?!l.tState:!l.state)&&(l.pure?u.push(l):g.push(l),l.observers&&W(l)),r||(l.state=w)}if(u.length>1e6)throw u=[],new Error},!1)),e}function m(t){if(!t.fn)return;y(t);const e=C;lt(t,t.value,e)}function lt(t,e,s){let n;const i=d,l=a;a=d=t;try{n=t.fn(e)}catch(r){return t.pure&&(t.state=w,t.owned&&t.owned.forEach(y),t.owned=null),t.updatedAt=s+1,X(r)}finally{a=l,d=i}(!t.updatedAt||t.updatedAt<=s)&&(t.updatedAt!=null&&"observers"in t?K(t,n):t.value=n,t.updatedAt=s)}function B(t,e,s,n=w,i){const l={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:d,context:d?d.context:null,pure:s};return d===null||d!==H&&(d.owned?d.owned.push(l):d.owned=[l]),l}function A(t){if(t.state===0)return;if(t.state===v)return T(t);if(t.suspense&&$(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<C);)t.state&&e.push(t);for(let s=e.length-1;s>=0;s--)if(t=e[s],t.state===w)m(t);else if(t.state===v){const n=u;u=null,x(()=>T(t,e[0]),!1),u=n}}function x(t,e){if(u)return t();let s=!1;e||(u=[]),g?s=!0:g=[],C++;try{const n=t();return ot(s),n}catch(n){s||(g=null),u=null,X(n)}}function ot(t){if(u&&(Q(u),u=null),t)return;const e=g;g=null,e.length&&x(()=>R(e),!1)}function Q(t){for(let e=0;e<t.length;e++)A(t[e])}function it(t){let e,s=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[s++]=n:A(n)}for(e=0;e<s;e++)A(t[e])}function T(t,e){t.state=0;for(let s=0;s<t.sources.length;s+=1){const n=t.sources[s];if(n.sources){const i=n.state;i===w?n!==e&&(!n.updatedAt||n.updatedAt<C)&&A(n):i===v&&T(n,e)}}}function W(t){for(let e=0;e<t.observers.length;e+=1){const s=t.observers[e];s.state||(s.state=v,s.pure?u.push(s):g.push(s),s.observers&&W(s))}}function y(t){let e;if(t.sources)for(;t.sources.length;){const s=t.sources.pop(),n=t.sourceSlots.pop(),i=s.observers;if(i&&i.length){const l=i.pop(),r=s.observerSlots.pop();n<i.length&&(l.sourceSlots[r]=n,i[n]=l,s.observerSlots[n]=r)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)y(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)y(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function rt(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function X(t,e=d){throw rt(t)}function ct(t,e){return $(()=>t(e||{}))}const M=t=>st(()=>t());function ft(t,e,s){let n=s.length,i=e.length,l=n,r=0,o=0,c=e[i-1].nextSibling,f=null;for(;r<i||o<l;){if(e[r]===s[o]){r++,o++;continue}for(;e[i-1]===s[l-1];)i--,l--;if(i===r){const h=l<n?o?s[o-1].nextSibling:s[l-o]:c;for(;o<l;)t.insertBefore(s[o++],h)}else if(l===o)for(;r<i;)(!f||!f.has(e[r]))&&e[r].remove(),r++;else if(e[r]===s[l-1]&&s[o]===e[i-1]){const h=e[--i].nextSibling;t.insertBefore(s[o++],e[r++].nextSibling),t.insertBefore(s[--l],h),e[i]=s[l]}else{if(!f){f=new Map;let p=o;for(;p<l;)f.set(s[p],p++)}const h=f.get(e[r]);if(h!=null)if(o<h&&h<l){let p=r,O=1,j;for(;++p<i&&p<l&&!((j=f.get(e[p]))==null||j!==h+O);)O++;if(O>h-o){const Y=e[r];for(;o<h;)t.insertBefore(s[o++],Y)}else t.replaceChild(s[o++],e[r++])}else r++;else e[r++].remove()}}}const P="_$DX_DELEGATE";function at(t,e,s,n={}){let i;return tt(l=>{i=l,e===document?t():D(e,t(),e.firstChild?null:void 0,s)},n.owner),()=>{i(),e.textContent=""}}function _(t,e,s,n){let i;const l=()=>{const o=document.createElement("template");return o.innerHTML=t,o.content.firstChild},r=()=>(i||(i=l())).cloneNode(!0);return r.cloneNode=r,r}function ut(t,e=window.document){const s=e[P]||(e[P]=new Set);for(let n=0,i=t.length;n<i;n++){const l=t[n];s.has(l)||(s.add(l),e.addEventListener(l,ht))}}function D(t,e,s,n){if(s!==void 0&&!n&&(n=[]),typeof e!="function")return E(t,e,n,s);N(i=>E(t,e(),i,s),n)}function ht(t){let e=t.target;const s=`$$${t.type}`,n=t.target,i=t.currentTarget,l=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),r=()=>{const c=e[s];if(c&&!e.disabled){const f=e[`${s}Data`];if(f!==void 0?c.call(e,f,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&l(e.host),!0},o=()=>{for(;r()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();l(c[0]);for(let f=0;f<c.length-2&&(e=c[f],!!r());f++){if(e._$host){e=e._$host,o();break}if(e.parentNode===i)break}}else o();l(n)}function E(t,e,s,n,i){for(;typeof s=="function";)s=s();if(e===s)return s;const l=typeof e,r=n!==void 0;if(t=r&&s[0]&&s[0].parentNode||t,l==="string"||l==="number"){if(l==="number"&&(e=e.toString(),e===s))return s;if(r){let o=s[0];o&&o.nodeType===3?o.data!==e&&(o.data=e):o=document.createTextNode(e),s=b(t,s,n,o)}else s!==""&&typeof s=="string"?s=t.firstChild.data=e:s=t.textContent=e}else if(e==null||l==="boolean")s=b(t,s,n);else{if(l==="function")return N(()=>{let o=e();for(;typeof o=="function";)o=o();s=E(t,o,s,n)}),()=>s;if(Array.isArray(e)){const o=[],c=s&&Array.isArray(s);if(L(o,e,s,i))return N(()=>s=E(t,o,s,n,!0)),()=>s;if(o.length===0){if(s=b(t,s,n),r)return s}else c?s.length===0?V(t,o,n):ft(t,s,o):(s&&b(t),V(t,o));s=o}else if(e.nodeType){if(Array.isArray(s)){if(r)return s=b(t,s,n,e);b(t,s,null,e)}else s==null||s===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);s=e}}return s}function L(t,e,s,n){let i=!1;for(let l=0,r=e.length;l<r;l++){let o=e[l],c=s&&s[t.length],f;if(!(o==null||o===!0||o===!1))if((f=typeof o)=="object"&&o.nodeType)t.push(o);else if(Array.isArray(o))i=L(t,o,c)||i;else if(f==="function")if(n){for(;typeof o=="function";)o=o();i=L(t,Array.isArray(o)?o:[o],Array.isArray(c)?c:[c])||i}else t.push(o),i=!0;else{const h=String(o);c&&c.nodeType===3&&c.data===h?t.push(c):t.push(document.createTextNode(h))}}return i}function V(t,e,s=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],s)}function b(t,e,s,n){if(s===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let l=!1;for(let r=e.length-1;r>=0;r--){const o=e[r];if(i!==o){const c=o.parentNode===t;!l&&!r?c?t.replaceChild(i,o):t.insertBefore(i,s):c&&o.remove()}else l=!0}}else t.insertBefore(i,s);return[i]}var F,G;const dt=(G=(F=globalThis.browser)==null?void 0:F.runtime)!=null&&G.id?globalThis.browser:globalThis.chrome,k=dt;async function pt(){return(await k.storage.local.get("authToken")).authToken||null}async function gt(t){await k.storage.local.set({authToken:t})}async function wt(){return(await k.storage.local.get("installationState")).installationState||{completed:!1,jwtVerified:!1}}async function bt(t){await k.storage.local.set({installationState:t})}var yt=_('<div class="min-h-screen bg-gradient-to-br from-gray-900 to-black flex items-center justify-center"><div class="max-w-2xl w-full p-12 text-center"><div class=mb-12><div class="text-8xl mb-6">ðŸŽ¤</div><h1 class="text-6xl font-bold text-white mb-4">Scarlett Karaoke</h1><p class="text-xl text-gray-400">AI-powered karaoke for SoundCloud'),mt=_('<div class=space-y-8><div class="w-20 h-20 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto"></div><p class="text-gray-400 text-xl">Setting up your account...'),xt=_('<div class=space-y-6><div class="p-6 bg-red-900/20 border border-red-800 rounded-xl"><p class="text-red-400 text-lg"></p></div><button class="text-gray-400 hover:text-white transition-colors">Try Again'),St=_(`<div class=space-y-8><div class="text-8xl mb-6">ðŸŽ‰</div><h2 class="text-4xl font-semibold text-white mb-4">You're All Set!</h2><p class="text-gray-400 text-xl">Extension setup complete. Closing in a moment...`);const vt=()=>{const[t,e]=U(!0),[s,n]=U(null),i=async()=>{try{await gt("scarlett_test_demo_user_12345"),await bt({completed:!0,jwtVerified:!0,timestamp:Date.now()}),console.log("[OnInstall] Demo account setup complete"),setTimeout(()=>{window.close()},2e3)}catch(l){console.error("[OnInstall] Setup failed:",l),n(l.message||"Failed to set up extension")}finally{e(!1)}};return nt(async()=>{const l=await pt(),r=await wt();if(l&&(r!=null&&r.completed)){console.log("[OnInstall] Already installed, closing window"),window.close();return}await i()}),(()=>{var l=yt(),r=l.firstChild;return r.firstChild,D(r,(()=>{var o=M(()=>!!t());return()=>o()?mt():M(()=>!!s())()?(()=>{var c=xt(),f=c.firstChild,h=f.firstChild,p=f.nextSibling;return D(h,s),p.$$click=()=>window.location.reload(),c})():St()})(),null),l})()};ut(["click"]);at(()=>ct(vt,{}),document.getElementById("root"));
